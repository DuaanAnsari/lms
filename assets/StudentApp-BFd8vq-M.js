import{r as i,j as e,u as w,a as D,N as I,O as $,b as A,c as k,R as T,d as v,e as E}from"./index-CaqurIt2.js";import{F as P,a as q,b as F,l as C,c as f}from"./apiUtils-4OWgz6zd.js";const O=({toggleSidebar:r})=>{const[h,u]=i.useState("Home"),[j,c]=i.useState(!0),[g,t]=i.useState(!1),[m,x]=i.useState(!1),[n,o]=i.useState(""),[p,N]=i.useState({username:"",email:"",firstLetter:""}),s=()=>{t(!g),x(!1)},a=()=>{x(!m),t(!1)},d=()=>{x(!1),t(!1),window.confirm("Are you sure you want to logout?")&&C("/")},b=[],S=[{id:5,label:"Logout",icon:e.jsx(F,{})}];return i.useEffect(()=>{const l=sessionStorage.getItem("userName"),y=sessionStorage.getItem("email"),L=l?l.charAt(0).toUpperCase():"";N({username:l,email:y,firstLetter:L})},[]),i.useEffect(()=>{const l=y=>{!y.target.closest(".notification-container")&&!y.target.closest(".profile-container")&&(t(!1),x(!1))};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[]),e.jsxs("header",{className:"main-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("button",{className:"mobile-toggle-btn",onClick:r,children:e.jsx("i",{className:"bi bi-list"})}),e.jsx("h1",{children:"Student Dashboard"})]}),e.jsxs("div",{className:"header-actions",children:[e.jsxs("div",{className:"notification-container",children:[e.jsxs("button",{className:"notification-btn",onClick:s,children:[e.jsx(P,{}),b.filter(l=>l.unread).length>0&&e.jsx("span",{className:"notification-badge",children:b.filter(l=>l.unread).length})]}),g&&e.jsxs("div",{className:"notification-dropdown",children:[e.jsxs("div",{className:"dropdown-header",children:[e.jsx("h3",{children:"Notifications"}),e.jsxs("span",{className:"notification-count",children:[b.filter(l=>l.unread).length," new"]})]}),e.jsx("div",{className:"notification-list",children:b.map(l=>e.jsxs("div",{className:`notification-item ${l.unread?"unread":""}`,children:[e.jsxs("div",{className:"notification-content",children:[e.jsx("h4",{children:l.title}),e.jsx("p",{children:l.message}),e.jsx("span",{className:"notification-time",children:l.time})]}),l.unread&&e.jsx("div",{className:"unread-dot"})]},l.id))}),e.jsx("div",{className:"dropdown-footer",children:e.jsx("button",{className:"view-all-btn",children:"View All Notifications"})})]})]}),e.jsxs("div",{className:"profile-container",children:[e.jsx("button",{className:"profile-btn",onClick:a,children:e.jsx(q,{})}),m&&e.jsxs("div",{className:"profile-dropdown",children:[e.jsxs("div",{className:"profile-header",children:[e.jsx("div",{className:"profile-avatar",children:p.firstLetter}),e.jsxs("div",{className:"profile-info",children:[e.jsx("h3",{children:p.username}),e.jsx("p",{children:p.email})]})]}),e.jsx("div",{className:"profile-menu",children:S.map(l=>e.jsxs("button",{className:"profile-option",onClick:l.label==="Logout"?d:void 0,children:[e.jsx("span",{className:"option-icon",children:l.icon}),e.jsx("span",{className:"option-label",children:l.label})]},l.id))})]})]})]})]})},U=({isSidebarOpen:r,toggleSidebar:h})=>{w();const u=D(),[j,c]=i.useState("Home"),[g,t]=i.useState(""),[m,x]=i.useState({username:"",email:"",firstLetter:""}),n=()=>{window.confirm("Are you sure you want to logout?")&&C("/")};i.useEffect(()=>{const s=sessionStorage.getItem("userName"),a=sessionStorage.getItem("email"),d=s?s.charAt(0).toUpperCase():"";x({username:s,email:a,firstLetter:d})},[]);const o=[{id:1,name:"Home",icon:"bi-house",path:"/student/dashboard/home"},{id:2,name:"Assignments",icon:"bi-clipboard-check",path:"/student/dashboard/assignments",badge:" "},{id:3,name:"Attendance",icon:"bi-calendar-check",path:"/student/dashboard/attendance"}],p=s=>t(s.target.value),N=()=>t("");return i.useEffect(()=>{const s=u.pathname.split("/").pop();if(s){const a=s.charAt(0).toUpperCase()+s.slice(1);c(a)}},[u.pathname]),e.jsxs("div",{className:`sidebar ${r?"open":"closed"}`,children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsxs("div",{className:"logo-section",children:[e.jsx("div",{className:"logo",children:"L"}),r&&e.jsx("h2",{className:"sidebar-title",children:"LMS Portal"})]}),e.jsx("button",{className:"sidebar-toggle",onClick:h,children:e.jsx("i",{className:`bi ${r?"bi-chevron-left":"bi-chevron-right"}`})})]}),e.jsx("div",{className:"search-section",children:r?e.jsxs("div",{className:"search-bar",children:[e.jsx("i",{className:"bi bi-search search-icon"}),e.jsx("input",{type:"text",placeholder:"Search...",className:"search-input",value:g,onChange:p}),g&&e.jsx("button",{className:"clear-search-btn",onClick:N,children:e.jsx("i",{className:"bi bi-x"})})]}):e.jsx("div",{className:"search-icon-only",children:e.jsx("i",{className:"bi bi-search"})})}),e.jsx("nav",{className:"sidebar-nav",children:e.jsxs("div",{className:"nav-section",children:[e.jsx("h3",{className:"section-title",children:"Main Menu"}),e.jsx("ul",{className:"sidebar-menu",children:o.map(s=>e.jsx("li",{className:"sidebar-item",children:e.jsxs(I,{to:s.path,onClick:()=>window.innerWidth<=768&&h(),className:({isActive:a})=>`sidebar-link ${a?"active":""}`,children:[e.jsx("i",{className:`bi ${s.icon} sidebar-icon`}),r&&e.jsx("span",{className:"sidebar-text",children:s.name}),s.badge&&e.jsx("span",{className:"nav-badge",children:s.badge})]})},s.id))})]})}),e.jsx("div",{className:"sidebar-footer",children:e.jsxs("div",{className:"logout-section",onClick:n,children:[e.jsx("i",{className:"bi bi-box-arrow-right logout-icon"}),r&&e.jsx("span",{className:"logout-text",children:"Log out"})]})})]})};function G(){const[r,h]=i.useState(window.innerWidth>768),u=()=>{h(!r)},j=()=>{window.innerWidth<=768&&h(!1)};return e.jsxs("div",{className:"dashboard-container",children:[e.jsx("div",{className:`sidebar-overlay ${r?"visible":""}`,onClick:j}),e.jsx(U,{isSidebarOpen:r,toggleSidebar:u}),e.jsxs("div",{className:`main-content ${r?"":"sidebar-closed"}`,children:[e.jsx(O,{toggleSidebar:u}),e.jsx("main",{className:"dashboard-main",children:e.jsx($,{})})]})]})}const Q=()=>{const r=w(),[h,u]=i.useState({}),j="http://192.168.0.105",c=sessionStorage.getItem("jwtToken");i.useEffect(()=>{(async()=>{try{const m=await f(`${j}/api/Student/GetAssignmentsWithStatus`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}}),x=await f(`${j}/api/Student/GetAttendance`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}});let n=0,o=0,p="0 / 0";if(m.ok){const N=await m.json();n=N.filter(d=>d.status?.toLowerCase()==="pending").length;const s=N.filter(d=>d.status?.toLowerCase()==="submitted"&&d.percentage!=null),a=s.reduce((d,b)=>d+(parseFloat(b.percentage)||0),0);o=s.length>0?Math.round(a/s.length):0}x.ok&&(p=(await x.json()).summary.formattedResult),u({courses:5,assignments:n,attendance:p,progress:o})}catch(m){console.error("Error fetching home stats:",m)}})()},[]);const g=[{title:"Active Courses",value:h.courses||0,icon:"bi-book",color:"#6b7280",bgColor:"rgba(107, 114, 128, 0.1)",trend:"+2 this week"},{title:"Pending Assignments",value:h.assignments||0,icon:"bi-clipboard-check",color:"#6b7280",bgColor:"rgba(107, 114, 128, 0.1)",trend:"Due soon",link:"/student/dashboard/assignments"},{title:"Attendance",value:h.attendance||"0 / 0",icon:"bi-calendar-check",color:"#4f46e5",bgColor:"rgba(79, 70, 229, 0.1)",trend:"View Details",link:"/student/dashboard/attendance"},{title:"Overall Progress",value:`${h.progress||0}%`,icon:"bi-graph-up",color:"#6b7280",bgColor:"rgba(107, 114, 128, 0.1)",trend:"+5% this month"}];return e.jsx("div",{className:"dashboard-content",children:e.jsx("div",{className:"dashboard-cards",children:g.map((t,m)=>e.jsxs("div",{className:"card modern-card",onClick:()=>t.link&&r(t.link),style:{cursor:t.link?"pointer":"default"},children:[e.jsx("div",{className:"card-gradient-bg",style:{background:t.bgColor}}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-icon-wrapper",style:{background:t.bgColor,border:`2px solid ${t.color}`},children:e.jsx("i",{className:`bi ${t.icon} card-icon`,style:{color:t.color}})}),e.jsxs("div",{className:"card-meta",children:[e.jsx("h3",{children:t.title}),e.jsx("span",{className:"card-trend",children:t.trend})]})]}),e.jsxs("div",{className:"card-value",children:[e.jsx("span",{className:"card-number",style:{color:t.color},children:t.value}),t.title==="Overall Progress"&&e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${h.progress||0}%`,background:t.color}})})]})]})]},m))})})},B=()=>{const r=w(),[h,u]=i.useState([]),[j,c]=i.useState(!0),g="http://192.168.0.105",t=sessionStorage.getItem("jwtToken"),{showSnackbar:m}=A();if(i.useEffect(()=>{(async()=>{try{const o=await f(`${g}/api/Student/GetAssignmentsWithStatus`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!o.ok)throw new Error("Failed to fetch assignments");const N=(await o.json()).map(s=>({id:s.assignmentId,title:s.title,subject:s.title,description:s.description,dueDate:new Date(s.dueDate).toLocaleDateString(),status:s.status.charAt(0).toUpperCase()+s.status.slice(1),assignmentType:s.assignmentType,percentage:s.percentage}));u(N),c(!1)}catch(o){console.error(o),c(!1)}})()},[]),j)return e.jsx("p",{children:"Loading assignments..."});const x=n=>{if(n.status==="Submitted"){m("This assignment has already been submitted.","info");return}n.assignmentType==="QA"?r(`/student/dashboard/solve-qa-assignment/${n.id}`,{state:{assignment:n}}):n.assignmentType==="MCQ"?r(`/student/dashboard/solve-assignment/${n.id}`,{state:{assignment:n}}):m("Unknown assignment type!","error")};return e.jsxs("div",{className:"dashboard-content",children:[e.jsxs("div",{className:"welcome-section",children:[e.jsx("h2",{children:"Assignments"}),e.jsx("p",{children:"Click on an assignment to solve it."})]}),e.jsx("div",{className:"dashboard-cards",children:h.map(n=>e.jsxs("div",{className:`card assignment-card ${n.status.toLowerCase()}`,onClick:()=>x(n),children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"assignment-title",children:n.title}),e.jsx("span",{className:`status-badge ${n.status.toLowerCase()}`,children:n.status})]}),e.jsxs("div",{className:"card-body",children:[e.jsxs("p",{className:"assignment-detail",children:[e.jsx("strong",{children:"Subject:"})," ",n.subject]}),e.jsxs("p",{className:"assignment-detail",children:[e.jsx("strong",{children:"Due Date:"})," ",n.dueDate]}),e.jsxs("p",{className:"assignment-detail description",children:[e.jsx("strong",{children:"Description:"})," ",n.description]})]}),n.status==="Submitted"&&n.percentage!==void 0&&e.jsxs("div",{className:"percentage-display",children:[e.jsx("span",{className:"percentage-label",children:"Score:"}),e.jsx("span",{className:"percentage-value",children:n.percentage})]})]},n.id))})]})},R=()=>{const{id:r}=k(),h=w(),u="http://192.168.0.105",j=sessionStorage.getItem("jwtToken"),[c,g]=i.useState(null),[t,m]=i.useState({}),[x,n]=i.useState(!0),{showSnackbar:o}=A();i.useEffect(()=>{(async()=>{try{const a=await f(`${u}/api/Student/GetAssignmentForStudents/${r}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`}});if(!a.ok)throw new Error("Failed to fetch assignment");const d=await a.json();g(d),n(!1)}catch(a){console.error(a),n(!1)}})()},[r]);const p=(s,a)=>{m({...t,[s]:a})},N=async()=>{if(!c)return;const s=c.questions.filter(a=>!t[a.questionId]);if(s.length>0){o(`Please answer all questions. ${s.length} question(s) remaining.`,"warning");return}try{const a=c.questions.map(b=>({questionId:b.questionId,selectedOption:t[b.questionId]}));if(!(await f(`${u}/api/Student/AssignmentSubmit`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify({assignmentId:c.assignmentId,answers:a})})).ok)throw new Error("Failed to submit assignment");o("Assignment submitted successfully!","success"),h("/student/dashboard/assignments")}catch(a){console.error(a),o("❌ Error submitting assignment","error")}};return x?e.jsx("p",{children:"Loading assignment..."}):c?e.jsxs("div",{className:"dashboard-content",style:{height:"100vh",overflowY:"auto"},children:[e.jsxs("div",{className:"welcome-section",children:[e.jsx("h2",{children:c.title}),e.jsxs("p",{children:["Due Date: ",new Date(c.dueDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"assignment-container",children:[c.questions.map((s,a)=>e.jsxs("div",{className:"question-block",children:[e.jsxs("h3",{children:["Question ",a+1]}),e.jsx("p",{className:"question-text",children:s.questionText}),e.jsx("div",{className:"options",children:["A","B","C","D"].map((d,b)=>{const S=s[`option${d}`];return e.jsxs("label",{className:"option",children:[e.jsx("input",{type:"radio",name:`question-${s.questionId}`,value:d,checked:t[s.questionId]===d,onChange:()=>p(s.questionId,d)}),e.jsx("span",{className:"option-text",children:S})]},b)})})]},s.questionId)),e.jsx("div",{className:"submit-section",children:e.jsx("button",{onClick:N,className:"submit-btn",children:"Submit Assignment"})})]})]}):e.jsx("p",{children:"Assignment not found"})},z=()=>{const{id:r}=k(),h=w(),u="http://192.168.0.105",j=sessionStorage.getItem("jwtToken"),[c,g]=i.useState(null),[t,m]=i.useState({}),[x,n]=i.useState(!0),{showSnackbar:o}=A();i.useEffect(()=>{(async()=>{try{const a=await f(`${u}/api/Student/GetAssignmentForStudents/${r}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`}});if(!a.ok)throw new Error("Failed to fetch assignment");const d=await a.json();g(d),n(!1)}catch(a){console.error(a),n(!1)}})()},[r]);const p=(s,a)=>{m({...t,[s]:a})},N=async()=>{if(!c)return;const s=c.questions.filter(a=>!t[a.questionId]||t[a.questionId].trim()==="");if(s.length>0){o(`Please answer all questions. ${s.length} question(s) remaining.`,"warning");return}try{const a=c.questions.map(b=>({questionId:b.questionId,answerText:t[b.questionId]}));if(!(await f(`${u}/api/Student/SubmitQaAssignment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j}`},body:JSON.stringify({assignmentId:c.assignmentId,answers:a})})).ok)throw new Error("Failed to submit assignment");o("Assignment submitted successfully!","success"),h("/student/dashboard/assignments")}catch(a){console.error(a),o("❌ Error submitting QA assignment","error")}};return x?e.jsx("p",{children:"Loading assignment..."}):c?e.jsxs("div",{className:"dashboard-content",style:{height:"100vh",overflowY:"auto"},children:[e.jsxs("div",{className:"welcome-section",children:[e.jsx("h2",{children:c.title}),e.jsxs("p",{children:["Due Date: ",new Date(c.dueDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"assignment-container",children:[c.questions.map((s,a)=>e.jsxs("div",{className:"question-block",children:[e.jsxs("h3",{children:["Question ",a+1]}),e.jsx("p",{className:"question-text",children:s.questionText}),e.jsx("textarea",{className:"qa-textarea",placeholder:"Write your answer here...",value:t[s.questionId]||"",onChange:d=>p(s.questionId,d.target.value)})]},s.questionId)),e.jsx("div",{className:"submit-section",children:e.jsx("button",{onClick:N,className:"submit-btn",children:"Submit Assignment"})})]})]}):e.jsx("p",{children:"Assignment not found"})},W=()=>{const[r,h]=i.useState(null),[u,j]=i.useState(!0),c="http://192.168.0.105",g=sessionStorage.getItem("jwtToken");if(i.useEffect(()=>{(async()=>{try{const o=await f(`${c}/api/Student/GetAttendance`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}});if(!o.ok)throw new Error("Failed to fetch attendance");const p=await o.json();h(p),j(!1)}catch(o){console.error("Error fetching attendance:",o),j(!1)}})()},[]),u)return e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading attendance details..."})]});if(!r)return e.jsx("div",{className:"empty-state",children:"No attendance records found."});const{summary:t,dayDetails:m,statistics:x}=r;return e.jsx("div",{className:"attendance-detail-page fade-in",children:e.jsxs("div",{className:"attendance-container",children:[e.jsx("div",{className:"page-header",children:e.jsxs("h1",{className:"page-title",children:[e.jsx("i",{className:"bi bi-calendar-check-fill header-icon"}),"Attendance Overview"]})}),e.jsxs("div",{className:"summary-grid",children:[e.jsxs("div",{className:"summary-card",children:[e.jsx("div",{className:"icon-wrapper",style:{background:"#e0e7ff",color:"#4f46e5"},children:e.jsx("i",{className:"bi bi-clipboard-data"})}),e.jsxs("div",{className:"summary-content",children:[e.jsx("h3",{children:"Total Days"}),e.jsx("span",{className:"summary-value",children:t.workingDaysPassed}),e.jsx("span",{className:"summary-subtext",children:"Working days passed"})]})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("div",{className:"icon-wrapper",style:{background:"#dcfce7",color:"#166534"},children:e.jsx("i",{className:"bi bi-check-lg"})}),e.jsxs("div",{className:"summary-content",children:[e.jsx("h3",{children:"Present"}),e.jsx("span",{className:"summary-value",children:t.presentDays}),e.jsxs("span",{className:"summary-subtext",children:[x.presentPercentage,"% Attendance"]})]})]}),e.jsxs("div",{className:"summary-card",children:[e.jsx("div",{className:"icon-wrapper",style:{background:"#fee2e2",color:"#991b1b"},children:e.jsx("i",{className:"bi bi-x-lg"})}),e.jsxs("div",{className:"summary-content",children:[e.jsx("h3",{children:"Absent"}),e.jsx("span",{className:"summary-value",children:t.absentDays}),e.jsxs("span",{className:"summary-subtext",children:[x.absentPercentage,"% Absence"]})]})]})]}),e.jsxs("div",{className:"attendance-list-section",children:[e.jsx("div",{className:"section-header",children:e.jsx("h2",{children:"Daily Attendance Log"})}),e.jsx("div",{className:"attendance-table-wrapper",children:e.jsxs("table",{className:"attendance-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Day"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:m.map((n,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(n.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}),e.jsx("td",{children:n.day}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${n.statusCode===1?"status-present":"status-absent"}`,children:n.statusCode===1?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-check-circle-fill"})," Present"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-x-circle-fill"})," Absent"]})})})]},o))})]})})]})]})})};function V(){return e.jsx(T,{children:e.jsxs(v,{path:"/dashboard/*",element:e.jsx(G,{}),children:[e.jsx(v,{index:!0,element:e.jsx(E,{to:"home"})}),e.jsx(v,{path:"home",element:e.jsx(Q,{})}),e.jsx(v,{path:"assignments",element:e.jsx(B,{})}),e.jsx(v,{path:"attendance",element:e.jsx(W,{})}),e.jsx(v,{path:"solve-assignment/:id",element:e.jsx(R,{})}),e.jsx(v,{path:"solve-qa-assignment/:id",element:e.jsx(z,{})})]})})}export{V as default};
